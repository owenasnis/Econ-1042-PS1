---
title: "Econ 1042 PS1"
author: "Owen Asnis"
date: "2023-02-01"
output: pdf_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(estimatr)
library(robustbase)

```

# Data Wrangling 

```{r data wrangling, message=FALSE}

kickers <- read_csv("kickers_v2.csv",
                    show_col_types = FALSE) %>%
  rename(., "ID" = "...1") %>%
  mutate(Grass = if_else(Grass == TRUE, 1, 0))

```

# Question 1

### a.)
```{r Q1a}

min <- min(kickers$Distance)
max <- max(kickers$Distance)
mean <- round(mean(kickers$Distance), digits = 3)
median <- median(kickers$Distance)

sprintf("Minimum distance: %s yards.", min)
sprintf("Maximum distance: %s yards.", max)
sprintf("Mean distance: %s yards", mean)
sprintf("Median distance: %s yards", median)

```

### b.) The minimum distance (18 yards) isn't lower for two reasons: First, the kicker must kick the ball through the end zone (accounting for 10 yards) in addition to the distance from the ball to the goal line, and second the ball is snapped a distance of 7 yards to the holder, who holds the ball for the kicker. Therefore, an 18 yard field goal actually begins at the 1 yard line, but the total distance of the kick is 10 yards (the end zone) + 7 yards (the snap) + 1 yard (the distance to the goal line) = 18 yards. 

### c.)
```{r Q1b}

max_distance_kick <- kickers %>% 
  filter(Distance == max(Distance))

print(max_distance_kick)

```
### The special circumstance that explains the maximum is that it occured in the 30th minute of the game, the last minute of the 2nd quarter before halftime. Therefore, in this instance, the Oakland Raiders were forced to try to score, because the half was ending and possession is assigned based on the result of the coin toss after the 2nd quarter, and decided they had a better chance of scoring on a very long field goal rather than a hail mary. 

# Question 2

```{r Q2}

forty_to_fortyfive <- kickers %>%
  filter(Distance %in% (40:45))

forty_to_fortyfive_success <- round((mean(forty_to_fortyfive$Success) * 100), 
                                    digits = 3)

over_fortyfive <- kickers %>% 
  filter(Distance > 45)

over_fortyfive_success <- round((mean(over_fortyfive$Success) * 100), 
                            digits = 3)

sprintf("Kicks from 40 to 45 yards made: %s percent", forty_to_fortyfive_success)
sprintf("Kicks over 45 yards made: %s percent", over_fortyfive_success)

```

# Question 3

```{r Q3}

grass_only <- kickers %>% 
  filter(Grass == 1)

mean(grass_only$Success) * 100

turf_only <- kickers %>% 
  filter(Grass == 0)

mean(turf_only$Success) * 100

lm1 <- lm_robust(Success ~ Grass, data = kickers)
summary(lm1)

```

# Question 4 

```{r Q4}

cor(kickers$Distance, kickers$Grass)
cor(kickers$Distance, kickers$Success)

```

# Question 5 

```{r Q5}

# short-form(coefficient) = long-form(coefficient) + (omitted variable coefficient)(correlation)

lm2 <- lm_robust(Success ~ Grass + Distance, data = kickers)
summary(lm2)

# becomes more negative (adding distance is omitted variable bias)

```

# Question 6

```{r Q6}

lm3 <- lm_robust(Success ~ Distance + Grass + ScoreDiff + GameMinute, 
                 data = kickers)
summary(lm3)

lm4 <- lm_robust(Success ~ Distance + Grass + ScoreDiff + GameMinute + Kicker, 
                 data = kickers)
summary(lm4)

# Accounts for the skill of the kicker 

```

# Question 7 

```{r Q7}

new_data <- kickers %>%
  filter(Kicker == "Tucker", 
         ScoreDiff == -11, 
         Year == 2015, 
         GameMinute == 30)

predict(lm4, newdata = new_data) * 100

# estimate - Tucker coefficient 

```
